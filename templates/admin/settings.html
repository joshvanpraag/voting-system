{% extends "admin/base.html" %}
{% block title %}Settings — Admin{% endblock %}

{% block admin_content %}
<h2 class="mb-4">Settings</h2>

<div class="row g-4">

  <!-- Google Sheets config -->
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header"><h5 class="mb-0">Google Sheets Integration</h5></div>
      <div class="card-body">
        <form method="POST">

          <div class="mb-3">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch"
                     name="sheets_enabled" id="sheets_enabled"
                     {{ 'checked' if sheets_enabled else '' }}>
              <label class="form-check-label fw-semibold" for="sheets_enabled">
                Enable automatic Google Sheets sync
              </label>
            </div>
            <div class="form-text">When enabled, votes sync to Sheets after each vote (debounced to ≤2 syncs/min).</div>
          </div>

          <div class="mb-4">
            <label class="form-label fw-semibold">Spreadsheet ID</label>
            <input type="text" name="spreadsheet_id" class="form-control font-monospace"
                   value="{{ spreadsheet_id }}"
                   placeholder="e.g. 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgVE2upms">
            <div class="form-text">
              Found in the Google Sheet URL:
              <code>…/spreadsheets/d/<strong>[ID]</strong>/edit</code>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Setup instructions -->
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header"><h5 class="mb-0">Google Sheets Setup Guide</h5></div>
      <div class="card-body">
        <ol class="mb-0">
          <li class="mb-2">
            Go to <a href="https://console.cloud.google.com" target="_blank" rel="noopener">console.cloud.google.com</a>
            → New Project
          </li>
          <li class="mb-2">
            APIs &amp; Services → Enable <strong>Google Sheets API</strong>
            and <strong>Google Drive API</strong>
          </li>
          <li class="mb-2">
            IAM &amp; Admin → Service Accounts → Create → Keys tab → Add Key → JSON
          </li>
          <li class="mb-2">
            Copy the downloaded file to:
            <code>credentials/google_service_account.json</code>
            on the Pi
          </li>
          <li class="mb-2">
            Run: <code>chmod 600 credentials/google_service_account.json</code>
          </li>
          <li class="mb-2">
            Open the JSON file, copy the <code>client_email</code> value
          </li>
          <li class="mb-2">
            Open your Google Sheet → Share → paste that email with
            <strong>Editor</strong> access
          </li>
          <li>
            Copy the Spreadsheet ID from the Sheet URL and paste it above
          </li>
        </ol>
      </div>
    </div>
  </div>

</div>
{% endblock %}
